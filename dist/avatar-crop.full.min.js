!function(){function a(a){var b={};for(var c in a)b[c]=a[c];return b}function b(a,b,c){a.addEventListener(b,c,!1)}function c(a,b){a.removeEventListener(b)}function d(){var a=document.createElement("canvas");return a.style.border="solid 1px #DDD",a.style.backgroundColor="#FFF",a.style.backgroundImage='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMzIgMzIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxyZWN0IGZpbGw9IiNDQ0NDQ0MiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIvPjxyZWN0IHg9IjE2IiB5PSIxNiIgZmlsbD0iI0NDQ0NDQyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PC9zdmc+")',a.style.userSelect="none",a.style.webkitUserSelect="none",a}function e(a,b,c){this.name=a,this.fn=b,this.configs=c||{}}function f(a,b){if(!a)throw"Missing element.";this.canvas=d(),this._callbacks={},this.filters=[],this.config(b),a.appendChild(this.canvas),this.clear()}var g=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),h={interactive:!0,droppable:!0,selectable:!0,width:null,height:null,message:"Drop an image or click to select one.",minZoom:1,maxZoom:1/0};e.prototype.exec=function(a,b,c){return this.fn.call(this,a,b,c)},e.prototype.config=function(a){for(var b in a)this.configs[b]=a[b]};var i=f.prototype;f.DEFAULT_WIDTH=256,f.DEFAULT_HEIGHT=256,f.DEFAULT_WHEEL_FACTOR=100,f.DEFAULT_ANIM_DURATE=250,f.DEFAULT_MODE="fit",f.filters={},f.Filter=e,f.registerFilter=function(a,b,c){f.filters[a]={fn:b,defaults:c}},i.config=function(b){var c=a(this.options||{}),d=this.options||a(h);if(b)for(var e in b)"undefined"!=typeof d[e]&&(d[e]=b[e]);this.canvas&&(this.canvas.width=d.width||f.DEFAULT_WIDTH,this.canvas.height=d.height||f.DEFAULT_HEIGHT,d.interactive&&!c.interactive?this.bindInteractive():c.interactive&&this.unbindInteractive(),d.droppable&&!c.droppable?this.bindDroppable():c.droppable&&this.unbindDroppable(),d.selectable&&!c.selectable?this.bindSelectable():c.selectable&&this.unbindSelectable()),this.options=d},i.addEventListener=function(a,b){this._callbacks[a]=this._callbacks[a]||[],this._callbacks[a].push(b)},i.fire=function(a){for(var b=this._callbacks[a]||[],c=0,d=b.length;d>c;c++)b[c].apply(this)},i.bindInteractive=function(){function a(a){h.data&&(j=a.clientX+h._offsetX,k=a.clientY+h._offsetY,m=!0)}function c(a){m=!1}function d(a){m&&h.move(a.clientX-j,a.clientY-k,1)}function e(a){if(h.data){if(m)return!0;a.stopPropagation(),a.preventDefault();var b=-(a.detail?-120*a.detail:a.wheelDelta)/f.DEFAULT_WHEEL_FACTOR;return h.zoom(h._zoom+b,1),l=b,!1}}function g(a){return h.data?(a.stopPropagation(),a.preventDefault(),1==h._zoom?0==h._offsetX&&0==h._offsetY?h.fill():h.center():h.fit(),!1):void 0}var h=this,i=this.canvas,j=(i.getContext("2d"),0),k=0,l=0,m=!1;b(i,"mousedown",a),b(i,"mousemove",d),b(i,"mouseup",c),b(i,"mouseout",c),b(i,"dblclick",g),b(i,"mousewheel",e),b(i,"DOMMouseScroll",e)},i.unbindInteractive=function(){var a=this.canvas;c(a,"mousedown"),c(a,"mousemove"),c(a,"mouseup"),c(a,"mouseout"),c(a,"dblclick"),c(a,"mousewheel"),c(a,"DOMMouseScroll")},i.bindDroppable=function(){var a=this,c=this.canvas;"undefined"!=typeof FileReader&&(b(c,"drop",function(b){b.preventDefault();var c=b.dataTransfer.files;c.length>0&&a.handleFile(c[0])}),b(c,"dragover",function(a){a.preventDefault()}))},i.unbindDroppable=function(){var a=this.canvas;c(a,"dragover"),c(a,"drop")},i.bindSelectable=function(){var a=this,c=this.canvas;b(c,"click",function(c){if(!a.data){var d=document.createElement("input");d.type="file",d.style.visibility="hidden",document.body.appendChild(d);var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),e.synthetic=!0,b(d,"change",function(b){this.files&&this.files[0]&&a.handleFile(this.files[0]),d.parentNode&&document.body.removeChild(d)}),setTimeout(function(){d.parentNode&&document.body.removeChild(d)},2e4),d.dispatchEvent(e,!0)}})},i.unbindSelectable=function(){c(this.canvas,"click")},i.setLoadState=function(a){var b=this,c=Date.now(),d=16,e=this.canvas,f=e.width,h=e.height,i=e.getContext("2d");if(a){b._loading=!0,e.style.cursor="progress";var j=function(){g(function(){var a=parseInt((new Date-c)/1e3*d)/d;i.save(),i.clearRect(0,0,f,h),i.translate(f/2,h/2),i.rotate(2*Math.PI*a);for(var e=0;d>e;e++)i.beginPath(),i.rotate(2*Math.PI/d),i.moveTo(f/10,0),i.lineTo(f/4,0),i.lineWidth=f/30,i.strokeStyle="rgba(0, 0, 0,"+e/d+")",i.stroke();i.restore(),b._loading&&j()})};j()}else i.clearRect(0,0,f,h),e.style.cursor="default",delete this._loading},i.handleFile=function(a){if(-1!==a.type.indexOf("image")){var b=this,c=new FileReader;b.setLoadState(!0),b.canvas.style.cursor="progress",c.onload=function(a){b.setLoadState(!1),b.setSource(a.target.result)},c.onerror=function(){b.setLoadState(!1)},c.readAsDataURL(a)}},i.setSource=function(a){var b=this,c=this.canvas,d=new Image;b.setLoadState(!0),d.addEventListener("load",function(){b.fire("load"),b.setLoadState(!1),b.data=d,b.reset(),b.options.interactive?c.style.cursor="move":c.style.cursor="default"}),img.addEventListener("error",function(){b.setLoadState(!1)}),d.src=a},i.fit=function(a){return this.moveAndZoom(0,0,1,a||f.DEFAULT_ANIM_DURATE)},i.fill=function(a){if(this.data){var b=this.data,c=b.width,d=b.height;d>c?this.moveAndZoom(0,0,d/c,a||f.DEFAULT_ANIM_DURATE):this.moveAndZoom(0,0,c/d,a||f.DEFAULT_ANIM_DURATE)}return this},i.move=function(a,b,c){return this.moveAndZoom(a,b,this._zoom,c)},i.zoom=function(a,b){var c=-this._offsetX/this._zoom*a,d=-this._offsetY/this._zoom*a;return this.moveAndZoom(c,d,a,b)},i.moveAndZoom=function(a,b,c,d){function e(a,b,c){f._offsetX=a,f._offsetY=b,f._zoom=c,d&&f.render()}if(this.data){d=d||0,a=-a,b=-b;var f=this,h=this.options,i=Date.now(),j=i+d,k=this._zoom,l=this._offsetX,m=this._offsetY,n=c-k,o=a-l,p=b-m;if(c=Math.min(Math.max(c,h.minZoom),h.maxZoom),d&&1!==d){var q=function(){g(function(){var a=Date.now(),b=Math.min(a-i,d)/d,c=n*b,f=k+c,g=o*b,h=l+g,r=p*b,s=m+r;e(h,s,f),j>a&&q()},10)};q()}else e(a,b,c)}return this},i.reset=function(a){return"function"==typeof this[f.DEFAULT_MODE]&&this[f.DEFAULT_MODE].call(this,a),this},i.center=function(a){return this.moveAndZoom(0,0,this._zoom,a||f.DEFAULT_ANIM_DURATE)},i.clear=function(){this.filters=[],this._offsetX=0,this._offsetY=0,this._zoom=1,this.data=null;var a=this.canvas,b=a.getContext("2d");b.clearRect(0,0,a.width,a.height),b.textAlign="center",b.fillText(this.options.message,a.width/2,a.height/2),this.options.selectable&&(a.style.cursor="pointer"),this.fire("clear")},i.render=function(){if(this.data){var a=this,b=this.data,c=this._zoom,d=this.canvas,e=d.getContext("2d"),f=b.width,g=b.height,h=f/g,i=this.filters;if(e.clearRect(0,0,d.width,d.height),1>h){var j=d.height*h;e.drawImage(b,0,0,f,g,(d.width-j*c)/2-this._offsetX,(d.height-d.height*c)/2-this._offsetY,j*c,d.height*c)}else{var k=d.width/h;e.drawImage(b,0,0,f,g,(d.width-d.width*c)/2-this._offsetX,(d.height-k*c)/2-this._offsetY,d.width*c,k*c)}for(var l=e.getImageData(0,0,d.width,d.height),m=0,n=i.length;n>m;m++)l=i[m].exec(this,l,d);e.putImageData(l,0,0),clearTimeout(a.fireTimeout),a.fireTimeout=setTimeout(function(){a.fire("change"),delete a.fireTimeout},250)}},i.save=function(){return this.data?this.canvas.toDataURL():void 0},i.hasFilter=function(a){for(var b=this.filters,c=0,d=b.length;d>c;c++)if(b[c].name==a)return!0;return!1},i.addFilter=function(a,b){if(this.hasFilter(a))return this;if("function"==typeof b)this.filters.push(new f.Filter(a,b));else if(f.filters[a]){var c=f.filters[a],d=new f.Filter(a,c.fn,c.defaults);b&&d.config(b),this.filters.push(d)}return this},i.removeFilter=function(a){var b=this.filters,c=0;for(b.length;c<b.length;c++)if(b[c].name==a)return this.filters.splice(c,1),this;return this},i.removeAllFilters=function(){return this.filters=[],this},i.updateFilter=function(a,b){var c=this.filters,d=0;for(c.length;d<c.length;d++)if(c[d].name==a)return c[d].config(b),this},"undefined"!=typeof module?module.exports=f:"function"==typeof define&&"object"==typeof define.amd?define(function(){return{AvatarCrop:f}}):window.AvatarCrop=f}(window),function(){AvatarCrop.execFilter=function(a,b,c){var d,e,f=b.getContext("2d"),g=b.width,h=b.height;(c.vignette||c.lighten)&&(d=Math.sqrt(Math.pow(g/2,2)+Math.pow(h/2,2))),c.vignette&&(f.globalCompositeOperation="source-over",e=f.createRadialGradient(g/2,h/2,0,g/2,h/2,d),e.addColorStop(0,"rgba(0,0,0,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,["rgba(0,0,0,",c.vignette,")"].join("")),f.fillStyle=e,f.fillRect(0,0,g,h)),c.lighten&&(f.globalCompositeOperation="lighter",e=f.createRadialGradient(g/2,h/2,0,g/2,h/2,d),e.addColorStop(0,["rgba(255,255,255,",c.lighten,")"].join("")),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(1,"rgba(0,0,0,0)"),f.fillStyle=e,f.fillRect(0,0,g,h));var i,j,k,l,m,n,o,p,q,r=a.data;c.contrast&&(q=259*(c.contrast+255)/(255*(259-c.contrast))),c.viewFinder&&(p=window.vjsImageCache[[g,h,c.viewFinder].join("-")]);for(var s=g*h;s>=0;--s)for(i=s<<2,c.curves&&(r[i]=c.curves.r[r[i]],r[i+1]=c.curves.g[r[i+1]],r[i+2]=c.curves.b[r[i+2]]),c.contrast&&(r[i]=q*(r[i]-128)+128,r[i+1]=q*(r[i+1]-128)+128,r[i+2]=q*(r[i+2]-128)+128),c.brightness&&(r[i]+=c.brightness,r[i+1]+=c.brightness,r[i+2]+=c.brightness),c.screen&&(r[i]=255-(255-r[i])*(255-c.screen.r*c.screen.a)/255,r[i+1]=255-(255-r[i+1])*(255-c.screen.g*c.screen.a)/255,r[i+2]=255-(255-r[i+2])*(255-c.screen.b*c.screen.a)/255),c.noise&&(o=c.noise-Math.random()*c.noise/2,r[i]+=o,r[i+1]+=o,r[i+2]+=o),c.viewFinder&&(r[i]=r[i]*p[i]/255,r[i+1]=r[i+1]*p[i+1]/255,r[i+2]=r[i+2]*p[i+2]/255),c.sepia&&(k=r[i],l=r[i+1],m=r[i+2],r[i]=.393*k+.769*l+.189*m,r[i+1]=.349*k+.686*l+.168*m,r[i+2]=.272*k+.534*l+.131*m),c.desaturate&&(n=(r[i]+r[i+1]+r[i+2])/3,r[i]+=(n-r[i])*c.desaturate,r[i+1]+=(n-r[i+1])*c.desaturate,r[i+2]+=(n-r[i+2])*c.desaturate),j=2;j>=0;--j)r[i+j]=~~(r[i+j]>255?255:r[i+j]<0?0:r[i+j]);return a}}(window),function(){function a(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function b(b,e,f,g,h,i){if(!(isNaN(i)||1>i)){i|=0;var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=b.data,I=i+i+1,J=g-1,K=h-1,L=i+1,M=L*(L+1)/2,N=new a,O=N;for(l=1;I>l;l++)if(O=O.next=new a,l==L)var P=O;O.next=N;var Q=null,R=null;p=o=0;var S=c[i],T=d[i];for(k=0;h>k;k++){for(y=z=A=B=q=r=s=t=0,u=L*(C=H[o]),v=L*(D=H[o+1]),w=L*(E=H[o+2]),x=L*(F=H[o+3]),q+=M*C,r+=M*D,s+=M*E,t+=M*F,O=N,l=0;L>l;l++)O.r=C,O.g=D,O.b=E,O.a=F,O=O.next;for(l=1;L>l;l++)m=o+((l>J?J:l)<<2),q+=(O.r=C=H[m])*(G=L-l),r+=(O.g=D=H[m+1])*G,s+=(O.b=E=H[m+2])*G,t+=(O.a=F=H[m+3])*G,y+=C,z+=D,A+=E,B+=F,O=O.next;for(Q=N,R=P,j=0;g>j;j++)H[o+3]=F=t*S>>T,0!=F?(F=255/F,H[o]=(q*S>>T)*F,H[o+1]=(r*S>>T)*F,H[o+2]=(s*S>>T)*F):H[o]=H[o+1]=H[o+2]=0,q-=u,r-=v,s-=w,t-=x,u-=Q.r,v-=Q.g,w-=Q.b,x-=Q.a,m=p+((m=j+i+1)<J?m:J)<<2,y+=Q.r=H[m],z+=Q.g=H[m+1],A+=Q.b=H[m+2],B+=Q.a=H[m+3],q+=y,r+=z,s+=A,t+=B,Q=Q.next,u+=C=R.r,v+=D=R.g,w+=E=R.b,x+=F=R.a,y-=C,z-=D,A-=E,B-=F,R=R.next,o+=4;p+=g}for(j=0;g>j;j++){for(z=A=B=y=r=s=t=q=0,o=j<<2,u=L*(C=H[o]),v=L*(D=H[o+1]),w=L*(E=H[o+2]),x=L*(F=H[o+3]),q+=M*C,r+=M*D,s+=M*E,t+=M*F,O=N,l=0;L>l;l++)O.r=C,O.g=D,O.b=E,O.a=F,O=O.next;for(n=g,l=1;i>=l;l++)o=n+j<<2,q+=(O.r=C=H[o])*(G=L-l),r+=(O.g=D=H[o+1])*G,s+=(O.b=E=H[o+2])*G,t+=(O.a=F=H[o+3])*G,y+=C,z+=D,A+=E,B+=F,O=O.next,K>l&&(n+=g);for(o=j,Q=N,R=P,k=0;h>k;k++)m=o<<2,H[m+3]=F=t*S>>T,F>0?(F=255/F,H[m]=(q*S>>T)*F,H[m+1]=(r*S>>T)*F,H[m+2]=(s*S>>T)*F):H[m]=H[m+1]=H[m+2]=0,q-=u,r-=v,s-=w,t-=x,u-=Q.r,v-=Q.g,w-=Q.b,x-=Q.a,m=j+((m=k+L)<K?m:K)*g<<2,q+=y+=Q.r=H[m],r+=z+=Q.g=H[m+1],s+=A+=Q.b=H[m+2],t+=B+=Q.a=H[m+3],Q=Q.next,u+=C=R.r,v+=D=R.g,w+=E=R.b,x+=F=R.a,y-=C,z-=D,A-=E,B-=F,R=R.next,o+=g}return b}}var c=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],d=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];AvatarCrop.registerFilter("blur",function(a,c,d){d.getContext("2d");return b(c,0,0,d.width,d.height,this.configs.radius)},{radius:5})}(),function(){AvatarCrop.registerFilter("greyscale",function(a,b,c){return AvatarCrop.execFilter(b,c,{desaturate:1})})}(),function(){AvatarCrop.registerFilter("negative",function(a,b,c){for(var d=(c.getContext("2d"),b.data),e=0;e<d.length;e+=4)d[e]=255-d[e],d[e+1]=255-d[e+1],d[e+2]=255-d[e+2];return b})}(),function(){AvatarCrop.registerFilter("sepia",function(a,b,c){return AvatarCrop.execFilter(b,c,{sepia:1})})}(),function(){AvatarCrop.registerFilter("vignette",function(a,b,c){var d=c.getContext("2d"),e=c.width,f=c.height,g=Math.sqrt(Math.pow(e/2,2)+Math.pow(f/2,2));d.putImageData(b,0,0),d.globalCompositeOperation="source-over";var h=d.createRadialGradient(e/2,f/2,0,e/2,f/2,g);return h.addColorStop(0,"rgba(0,0,0,0)"),h.addColorStop(.5,"rgba(0,0,0,0)"),h.addColorStop(1,["rgba(0,0,0,",this.configs.radius,")"].join("")),d.fillStyle=h,d.fillRect(0,0,e,f),b=d.getImageData(0,0,e,f)},{radius:.16})}();
//# sourceMappingURL=avatar-crop.full.min.js.map