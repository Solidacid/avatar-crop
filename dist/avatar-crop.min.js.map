{"version":3,"file":"avatar-crop.min.js","sources":["../src/avatar-crop.js"],"names":["clone","obj","res","k","bind","elem","evt","fn","addEventListener","unbind","removeEventListener","createBoard","c","document","createElement","style","border","backgroundColor","backgroundImage","userSelect","webkitUserSelect","AvatarCropFilter","name","defaults","this","configs","AvatarCrop","el","options","canvas","_callbacks","filters","config","appendChild","clear","myRequestAnimFrame","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setTimeout","interactive","droppable","selectable","width","height","message","minZoom","maxZoom","Infinity","prototype","exec","self","call","data","proto","DEFAULT_WIDTH","DEFAULT_HEIGHT","DEFAULT_WHEEL_FACTOR","DEFAULT_ANIM_DURATE","DEFAULT_MODE","Filter","registerFilter","old","opt","bindInteractive","unbindInteractive","bindDroppable","unbindDroppable","bindSelectable","unbindSelectable","push","fire","clbs","i","len","length","apply","handleMouseDown","e","canMouseX","clientX","_offsetX","canMouseY","clientY","_offsetY","isDragging","handleMouseUp","handleMouseMove","move","handleMouseWheel","stopPropagation","preventDefault","delta","detail","wheelDelta","zoom","_zoom","wheel","handleDblClick","fill","center","fit","getContext","FileReader","files","dataTransfer","handleFile","input","type","visibility","body","ev","createEvent","initEvent","synthetic","fileEv","parentNode","removeChild","dispatchEvent","setLoadState","load","start","Date","now","lines","cW","cH","context","_loading","cursor","draw","rotation","parseInt","save","clearRect","translate","rotate","Math","PI","beginPath","moveTo","lineTo","lineWidth","strokeStyle","stroke","restore","file","indexOf","reader","onload","setSource","target","result","onerror","readAsDataURL","image","Image","reset","img","src","durate","moveAndZoom","imageW","imageH","x","y","setVals","xTmp","yTmp","zoomTmp","render","end","startZoom","startX","startY","rangeZoom","rangeX","rangeY","min","max","animate","time","frame","fracZoom","fracX","fracY","ctx","textAlign","fillText","rap","w","drawImage","h","clearTimeout","fireTimeout","toDataURL","hasFilter","addFilter","filterDef","filter","removeFilter","splice","removeAllFilters","updateFilter","module","exports","define","amd"],"mappings":"CAAA,WAWE,QAASA,GAAMC,GACb,GAAIC,KACJ,KAAK,GAAIC,KAAKF,GAAKC,EAAIC,GAAKF,EAAIE,EAChC,OAAOD,GAGT,QAASE,GAAKC,EAAMC,EAAKC,GACvBF,EAAKG,iBAAiBF,EAAKC,GAAI,GAGjC,QAASE,GAAOJ,EAAMC,GACpBD,EAAKK,oBAAoBJ,GAG3B,QAASK,KACP,GAAIC,GAAIC,SAASC,cAAc,SAM/B,OALAF,GAAEG,MAAMC,OAAS,iBACjBJ,EAAEG,MAAME,gBAAkB,OAC1BL,EAAEG,MAAMG,gBAAkB,4pBAC1BN,EAAEG,MAAMI,WAAa,OACrBP,EAAEG,MAAMK,iBAAmB,OACpBR,EAcT,QAASS,GAAiBC,EAAMf,EAAIgB,GAClCC,KAAKF,KAAOA,EACZE,KAAKjB,GAAKA,EACViB,KAAKC,QAAUF,MAajB,QAASG,GAAWC,EAAIC,GACtB,IAAKD,EACH,KAAM,kBAGRH,MAAKK,OAASlB,IACda,KAAKM,cACLN,KAAKO,WACLP,KAAKQ,OAAOJ,GACZD,EAAGM,YAAYT,KAAKK,QACpBL,KAAKU,QAtEP,GAAIC,GAAqB,WACvB,MAAOC,QAAOC,uBACZD,OAAOE,6BACPF,OAAOG,0BACP,SAASC,GACPJ,OAAOK,WAAWD,EAAU,IAAO,QA4BrCjB,GACFmB,aAAa,EACbC,WAAW,EACXC,YAAY,EACZC,MAAO,KACPC,OAAQ,KACRC,QAAS,wCACTC,QAAS,EACTC,QAASC,EAAAA,EASX7B,GAAiB8B,UAAUC,KAAO,SAASC,EAAMxB,GAC/CL,KAAKjB,GAAG+C,KAAK9B,KAAM6B,EAAMxB,IAG3BR,EAAiB8B,UAAUnB,OAAS,SAASuB,GAC3C,IAAK,GAAIpD,KAAKoD,GACZ/B,KAAKC,QAAQtB,GAAKoD,EAAKpD,GAiB3B,IAAIqD,GAAQ9B,EAAWyB,SAEvBzB,GAAW+B,cAAgB,IAC3B/B,EAAWgC,eAAiB,IAC5BhC,EAAWiC,qBAAuB,IAClCjC,EAAWkC,oBAAsB,IACjClC,EAAWmC,aAAe,MAC1BnC,EAAWK,WACXL,EAAWoC,OAASzC,EAEpBK,EAAWqC,eAAiB,SAASzC,EAAMf,EAAIyB,GAC7CN,EAAWK,QAAQT,IACjBf,GAAIA,EACJgB,SAAUS,IAIdwB,EAAMxB,OAAS,SAASJ,GACtB,GAAIoC,GAAMhE,EAAMwB,KAAKI,aACjBqC,EAAMzC,KAAKI,SAAW5B,EAAMuB,EAChC,IAAIK,EACF,IAAK,GAAIzB,KAAKyB,GACU,mBAAXqC,GAAI9D,KACb8D,EAAI9D,GAAKyB,EAAQzB,GAInBqB,MAAKK,SACPL,KAAKK,OAAOgB,MAAQoB,EAAIpB,OAASnB,EAAW+B,cAC5CjC,KAAKK,OAAOiB,OAASmB,EAAInB,QAAUpB,EAAWgC,eAC1CO,EAAIvB,cAAgBsB,EAAItB,YAC1BlB,KAAK0C,kBACIF,EAAItB,aACblB,KAAK2C,oBAEHF,EAAItB,YAAcqB,EAAIrB,UACxBnB,KAAK4C,gBACIJ,EAAIrB,WACbnB,KAAK6C,kBAEHJ,EAAIrB,aAAeoB,EAAIpB,WACzBpB,KAAK8C,iBACIN,EAAIpB,YACbpB,KAAK+C,oBAGT/C,KAAKI,QAAUqC,GAGjBT,EAAMhD,iBAAmB,SAASc,EAAMf,GACtCiB,KAAKM,WAAWR,GAAQE,KAAKM,WAAWR,OACxCE,KAAKM,WAAWR,GAAMkD,KAAKjE,IAG7BiD,EAAMiB,KAAO,SAASnE,GAEpB,IAAK,GADDoE,GAAOlD,KAAKM,WAAWxB,OAClBqE,EAAI,EAAGC,EAAMF,EAAKG,OAAYD,EAAJD,EAASA,IAC1CD,EAAKC,GAAGG,MAAMtD,OAIlBgC,EAAMU,gBAAkB,WAStB,QAASa,GAAgBC,GACnB3B,EAAKE,OACP0B,EAAYD,EAAEE,QAAU7B,EAAK8B,SAC7BC,EAAYJ,EAAEK,QAAUhC,EAAKiC,SAC7BC,GAAa,GAIjB,QAASC,GAAcR,GACrBO,GAAa,EAGf,QAASE,GAAgBT,GACnBO,GACFlC,EAAKqC,KAAKV,EAAEE,QAAUD,EAAWD,EAAEK,QAAUD,EAAW,GAI5D,QAASO,GAAiBX,GACxB,GAAI3B,EAAKE,KAAM,CACb,GAAIgC,EAAY,OAAO,CACvBP,GAAEY,kBACFZ,EAAEa,gBACF,IAAIC,KAAUd,EAAEe,OAAoB,KAAXf,EAAEe,OAAkBf,EAAEgB,YAActE,EAAWiC,oBAGxE,OAFAN,GAAK4C,KAAK5C,EAAK6C,MAAQJ,EAAO,GAC9BK,EAAQL,GACD,GAIX,QAASM,GAAepB,GACtB,MAAI3B,GAAKE,MACPyB,EAAEY,kBACFZ,EAAEa,iBACgB,GAAdxC,EAAK6C,MACc,GAAjB7C,EAAK8B,UAAkC,GAAjB9B,EAAKiC,SAC7BjC,EAAKgD,OAELhD,EAAKiD,SAGPjD,EAAKkD,OAEA,GAZT,OAvCF,GAAIlD,GAAO7B,KACPK,EAASL,KAAKK,OAEdoD,GADMpD,EAAO2E,WAAW,MACZ,GACZpB,EAAY,EACZe,EAAQ,EACRZ,GAAa,CAiDjBnF,GAAKyB,EAAQ,YAAakD,GAC1B3E,EAAKyB,EAAQ,YAAa4D,GAC1BrF,EAAKyB,EAAQ,UAAW2D,GACxBpF,EAAKyB,EAAQ,WAAY2D,GACzBpF,EAAKyB,EAAQ,WAAYuE,GACzBhG,EAAKyB,EAAQ,aAAc8D,GAC3BvF,EAAKyB,EAAQ,iBAAkB8D,IAGjCnC,EAAMW,kBAAoB,WACxB,GAAItC,GAASL,KAAKK,MAClBpB,GAAOoB,EAAQ,aACfpB,EAAOoB,EAAQ,aACfpB,EAAOoB,EAAQ,WACfpB,EAAOoB,EAAQ,YACfpB,EAAOoB,EAAQ,YACfpB,EAAOoB,EAAQ,cACfpB,EAAOoB,EAAQ,mBAGjB2B,EAAMY,cAAgB,WACpB,GAAIf,GAAO7B,KACPK,EAASL,KAAKK,MACQ,oBAAf4E,cACTrG,EAAKyB,EAAQ,OAAQ,SAASmD,GAC5BA,EAAEa,gBACF,IAAIa,GAAQ1B,EAAE2B,aAAaD,KACvBA,GAAM7B,OAAS,GACjBxB,EAAKuD,WAAWF,EAAM,MAI1BtG,EAAKyB,EAAQ,WAAY,SAASmD,GAChCA,EAAEa,qBAKRrC,EAAMa,gBAAkB,WACtB,GAAIxC,GAASL,KAAKK,MAClBpB,GAAOoB,EAAQ,YACfpB,EAAOoB,EAAQ,SAGjB2B,EAAMc,eAAiB,WACrB,GAAIjB,GAAO7B,KACPK,EAASL,KAAKK,MAClBzB,GAAKyB,EAAQ,QAAS,SAASmD,GAC7B,IAAK3B,EAAKE,KAAM,CACd,GAAIsD,GAAQhG,SAASC,cAAc,QACnC+F,GAAMC,KAAO,OACbD,EAAM9F,MAAMgG,WAAa,SACzBlG,SAASmG,KAAK/E,YAAY4E,EAC1B,IAAII,GAAKpG,SAASqG,YAAY,cAC9BD,GAAGE,UAAU,SAAS,GAAM,GAC5BF,EAAGG,WAAY,EAEfhH,EAAKyG,EAAO,SAAU,SAASQ,GACzB7F,KAAKkF,OAASlF,KAAKkF,MAAM,IAC3BrD,EAAKuD,WAAWpF,KAAKkF,MAAM,IAEzBG,EAAMS,YACRzG,SAASmG,KAAKO,YAAYV,KAG9BpE,WAAW,WACLoE,EAAMS,YACRzG,SAASmG,KAAKO,YAAYV,IAE3B,KAEHA,EAAMW,cAAcP,GAAI,OAK9BzD,EAAMe,iBAAmB,WACvB9D,EAAOe,KAAKK,OAAQ,UAGtB2B,EAAMiE,aAAe,SAASC,GAC5B,GAAIrE,GAAO7B,KACTmG,EAAQC,KAAKC,MACbC,EAAQ,GACRjG,EAASL,KAAKK,OACdkG,EAAKlG,EAAOgB,MACZmF,EAAKnG,EAAOiB,OACZmF,EAAUpG,EAAO2E,WAAW,KAC9B,IAAIkB,EAAM,CAERrE,EAAK6E,UAAW,EAChBrG,EAAOd,MAAMoH,OAAS,UACtB,IAAIC,GAAO,WACTjG,EAAmB,WACjB,GAAIkG,GAAWC,UAAW,GAAIV,MAASD,GAAS,IAAQG,GAASA,CACjEG,GAAQM,OACRN,EAAQO,UAAU,EAAG,EAAGT,EAAIC,GAC5BC,EAAQQ,UAAUV,EAAK,EAAGC,EAAK,GAC/BC,EAAQS,OAAiB,EAAVC,KAAKC,GAASP,EAC7B,KAAK,GAAI1D,GAAI,EAAOmD,EAAJnD,EAAWA,IACzBsD,EAAQY,YACRZ,EAAQS,OAAiB,EAAVC,KAAKC,GAASd,GAC7BG,EAAQa,OAAOf,EAAK,GAAI,GACxBE,EAAQc,OAAOhB,EAAK,EAAG,GACvBE,EAAQe,UAAYjB,EAAK,GACzBE,EAAQgB,YAAc,gBAAkBtE,EAAImD,EAAQ,IACpDG,EAAQiB,QAEVjB,GAAQkB,UACJ9F,EAAK6E,UACPE,MAINA,SAEAH,GAAQO,UAAU,EAAG,EAAGT,EAAIC,GAC5BnG,EAAOd,MAAMoH,OAAS,gBACf3G,MAAK0G,UAIhB1E,EAAMoD,WAAa,SAASwC,GAC1B,GAAmC,KAA/BA,EAAKtC,KAAKuC,QAAQ,SAAiB,CACrC,GAAIhG,GAAO7B,KACT8H,EAAS,GAAI7C,WACfpD,GAAKoE,cAAa,GAClBpE,EAAKxB,OAAOd,MAAMoH,OAAS,WAC3BmB,EAAOC,OAAS,SAASvE,GACvB3B,EAAKoE,cAAa,GAClBpE,EAAKmG,UAAUxE,EAAEyE,OAAOC,SAE1BJ,EAAOK,QAAU,WACftG,EAAKoE,cAAa,IAEpB6B,EAAOM,cAAcR,KAIzB5F,EAAMgG,UAAY,SAASjG,GACzB,GAAIF,GAAO7B,KACTK,EAASL,KAAKK,OACdgI,EAAQ,GAAIC,MAEdzG,GAAKoE,cAAa,GAClBoC,EAAMrJ,iBAAiB,OAAQ,WAC7B6C,EAAKoB,KAAK,QACVpB,EAAKoE,cAAa,GAClBpE,EAAKE,KAAOsG,EACZxG,EAAK0G,QACD1G,EAAKzB,QAAQc,YACfb,EAAOd,MAAMoH,OAAS,OAEtBtG,EAAOd,MAAMoH,OAAS,YAG1B6B,IAAIxJ,iBAAiB,QAAS,WAC5B6C,EAAKoE,cAAa,KAEpBoC,EAAMI,IAAM1G,GAGdC,EAAM+C,IAAM,SAAS2D,GACnB,MAAO1I,MAAK2I,YAAY,EAAG,EAAG,EAAGD,GAAUxI,EAAWkC,sBAGxDJ,EAAM6C,KAAO,SAAS6D,GACpB,GAAI1I,KAAK+B,KAAM,CACb,GAAIsG,GAAQrI,KAAK+B,KACf6G,EAASP,EAAMhH,MACfwH,EAASR,EAAM/G,MACbuH,GAASD,EACX5I,KAAK2I,YAAY,EAAG,EAAGE,EAASD,EAAQF,GAAUxI,EAAWkC,qBAE7DpC,KAAK2I,YAAY,EAAG,EAAGC,EAASC,EAAQH,GAAUxI,EAAWkC,qBAGjE,MAAOpC,OAGTgC,EAAMkC,KAAO,SAAS4E,EAAGC,EAAGL,GAC1B,MAAO1I,MAAK2I,YAAYG,EAAGC,EAAG/I,KAAK0E,MAAOgE,IAG5C1G,EAAMyC,KAAO,SAASA,EAAMiE,GAC1B,GAAII,IAAM9I,KAAK2D,SAAW3D,KAAK0E,MAASD,EACtCsE,GAAM/I,KAAK8D,SAAW9D,KAAK0E,MAASD,CACtC,OAAOzE,MAAK2I,YAAYG,EAAGC,EAAGtE,EAAMiE,IAGtC1G,EAAM2G,YAAc,SAASG,EAAGC,EAAGtE,EAAMiE,GAkBrC,QAASM,GAAQC,EAAMC,EAAMC,GAC3BtH,EAAK8B,SAAWsF,EAChBpH,EAAKiC,SAAWoF,EAChBrH,EAAK6C,MAAQyE,EACTT,GACA7G,EAAKuH,SAtBb,GAAIpJ,KAAK+B,KAAM,CACb2G,EAASA,GAAU,EACnBI,GAAKA,EACLC,GAAKA,CACL,IAAIlH,GAAO7B,KACTI,EAAUJ,KAAKI,QACf+F,EAAQC,KAAKC,MACbgD,EAAMlD,EAAQuC,EACdY,EAAYtJ,KAAK0E,MACjB6E,EAASvJ,KAAK2D,SACd6F,EAASxJ,KAAK8D,SACd2F,EAAYhF,EAAO6E,EACnBI,EAASZ,EAAIS,EACbI,EAASZ,EAAIS,CAaf,IAXA/E,EAAO0C,KAAKyC,IAAIzC,KAAK0C,IAAIpF,EAAMrE,EAAQoB,SAAUpB,EAAQqB,SAWrDiH,GAAqB,IAAXA,EAAc,CAC1B,GAAIoB,GAAU,WACZnJ,EAAmB,WACjB,GAAIoJ,GAAO3D,KAAKC,MACd2D,EAAQ7C,KAAKyC,IAAIG,EAAO5D,EAAOuC,GAAUA,EACzCuB,EAAWR,EAAYO,EACvBb,EAAUG,EAAYW,EACtBC,EAAQR,EAASM,EACjBf,EAAOM,EAASW,EAChBC,EAAQR,EAASK,EACjBd,EAAOM,EAASW,CAElBnB,GAAQC,EAAMC,EAAMC,GACTE,EAAPU,GAAYD,KACf,IAELA,SAEAd,GAAQF,EAAGC,EAAGtE,GAGlB,MAAOzE,OAGTgC,EAAMuG,MAAQ,SAASG,GAIrB,MAH4C,kBAAjC1I,MAAKE,EAAWmC,eACzBrC,KAAKE,EAAWmC,cAAcP,KAAK9B,KAAM0I,GAEpC1I,MAGTgC,EAAM8C,OAAS,SAAS4D,GACtB,MAAO1I,MAAK2I,YAAY,EAAG,EAAG3I,KAAK0E,MAAOgE,GAAUxI,EAAWkC,sBAGjEJ,EAAMtB,MAAQ,WACZV,KAAKO,WACLP,KAAK2D,SAAW,EAChB3D,KAAK8D,SAAW,EAChB9D,KAAK0E,MAAQ,EACb1E,KAAK+B,KAAO,IACZ,IAAI1B,GAASL,KAAKK,OACd+J,EAAM/J,EAAO2E,WAAW,KAC5BoF,GAAIpD,UAAU,EAAG,EAAG3G,EAAOgB,MAAOhB,EAAOiB,QACzC8I,EAAIC,UAAY,SAChBD,EAAIE,SAAStK,KAAKI,QAAQmB,QAASlB,EAAOgB,MAAQ,EAAGhB,EAAOiB,OAAS,GACjEtB,KAAKI,QAAQgB,aACff,EAAOd,MAAMoH,OAAS,WAExB3G,KAAKiD,KAAK,UAGZjB,EAAMoH,OAAS,WACb,GAAIpJ,KAAK+B,KAAM,CACb,GAAIF,GAAO7B,KACTqI,EAAQrI,KAAK+B,KACb0C,EAAOzE,KAAK0E,MACZrE,EAASL,KAAKK,OACd+J,EAAM/J,EAAO2E,WAAW,MACxB4D,EAASP,EAAMhH,MACfwH,EAASR,EAAM/G,OACfiJ,EAAM3B,EAASC,EACftI,EAAUP,KAAKO,OAGjB,IADA6J,EAAIpD,UAAU,EAAG,EAAG3G,EAAOgB,MAAOhB,EAAOiB,QAC/B,EAANiJ,EAAS,CACX,GAAIC,GAAInK,EAAOiB,OAASiJ,CACxBH,GAAIK,UAAUpC,EAAO,EAAG,EAAGO,EAAQC,GAASxI,EAAOgB,MAAQmJ,EAAI/F,GAAQ,EAAIzE,KAAK2D,UAAWtD,EAAOiB,OAASjB,EAAOiB,OAASmD,GAAQ,EAAIzE,KAAK8D,SAAU0G,EAAI/F,EAAMpE,EAAOiB,OAASmD,OAC3K,CACL,GAAIiG,GAAIrK,EAAOgB,MAAQkJ,CACvBH,GAAIK,UAAUpC,EAAO,EAAG,EAAGO,EAAQC,GAASxI,EAAOgB,MAAQhB,EAAOgB,MAAQoD,GAAQ,EAAIzE,KAAK2D,UAAWtD,EAAOiB,OAASoJ,EAAIjG,GAAQ,EAAIzE,KAAK8D,SAAUzD,EAAOgB,MAAQoD,EAAMiG,EAAIjG,GAGhL,IAAK,GAAItB,GAAI,EAAGC,EAAM7C,EAAQ8C,OAAYD,EAAJD,EAASA,IAC7C5C,EAAQ4C,GAAGvB,KAAK5B,KAAMK,EAExBsK,cAAa9I,EAAK+I,aAClB/I,EAAK+I,YAAc3J,WAAW,WAC5BY,EAAKoB,KAAK,gBACHpB,GAAK+I,aACX,OAIP5I,EAAM+E,KAAO,WACX,MAAI/G,MAAK+B,KACA/B,KAAKK,OAAOwK,YADrB,QAKF7I,EAAM8I,UAAY,SAAShL,GAEzB,IAAK,GADDS,GAAUP,KAAKO,QACV4C,EAAI,EAAGC,EAAM7C,EAAQ8C,OAAYD,EAAJD,EAASA,IAC7C,GAAI5C,EAAQ4C,GAAGrD,MAAQA,EACrB,OAAO,CAGX,QAAO,GAGTkC,EAAM+I,UAAY,SAASjL,EAAMf,GAC/B,GAAIiB,KAAK8K,UAAUhL,GACjB,MAAOE,KAET,IAAiB,kBAANjB,GACTiB,KAAKO,QAAQyC,KAAK,GAAI9C,GAAWoC,OAAOxC,EAAMf,QACzC,IAAImB,EAAWK,QAAQT,GAAO,CACnC,GAAIkL,GAAY9K,EAAWK,QAAQT,GACjCmL,EAAS,GAAI/K,GAAWoC,OAAOxC,EAAMkL,EAAUjM,GAAIiM,EAAUjL,SAC3DhB,IACFkM,EAAOzK,OAAOzB,GAEhBiB,KAAKO,QAAQyC,KAAKiI,GAEpB,MAAOjL,OAGTgC,EAAMkJ,aAAe,SAASpL,GAEvB,GADDS,GAAUP,KAAKO,QACV4C,EAAI,CAAb,KAAsB5C,EAAQ8C,OAAQF,EAAI5C,EAAQ8C,OAAQF,IACxD,GAAI5C,EAAQ4C,GAAGrD,MAAQA,EAErB,MADAE,MAAKO,QAAQ4K,OAAOhI,EAAG,GAChBnD,IAGX,OAAOA,OAGTgC,EAAMoJ,iBAAmB,WAEvB,MADApL,MAAKO,WACEP,MAGTgC,EAAMqJ,aAAe,SAASvL,EAAMM,GAE7B,GADDG,GAAUP,KAAKO,QACV4C,EAAI,CAAb,KAAsB5C,EAAQ8C,OAAQF,EAAI5C,EAAQ8C,OAAQF,IACxD,GAAI5C,EAAQ4C,GAAGrD,MAAQA,EAErB,MADAS,GAAQ4C,GAAG3C,OAAOJ,GACXJ,MAKQ,mBAAVsL,QACTA,OAAOC,QAAUrL,EACS,kBAAVsL,SAA6C,gBAAdA,QAAOC,IACtDD,OAAO,WACL,OACEtL,WAAcA,KAIlBU,OAAOV,WAAaA,GAGrBU"}